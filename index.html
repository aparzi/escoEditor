<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>jsTree test</title>
  <!-- 2 load the theme CSS file -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jstree/3.3.3/themes/default/style.min.css" />
  <script src="//cdnjs.cloudflare.com/ajax/libs/jstree/3.3.3/jstree.min.js"></script>
</head>

<body>

  <div id="container"></div>
  <div>
    <button onclick="save()">Salva</button>
  </div>
  <script>
$(function() {
  $('#container').jstree({
    'core' : {
      'data' : {
        "url" : "http://oldhand.datasounds.io/api/occupations/hierarchy",
        "dataType" : "json",

        beforeSend: function(xhr) {
          xhr.setRequestHeader("X-oldhand-auth", "fc6add639e80f76e047f642fe6952168");
        },

        success : function(json) {
          
        },

        error : function(xhr, ajaxOptions, thrownError) {
            alert('Chiamata fallita riprovare!')
        }
      },
      "check_callback" : true, // enable all modifications
    },
    "plugins" : ["dnd","contextmenu"]
  });
});

function save () {
  var v =$('#container').jstree(false ).get_json();
   var mytext = JSON.stringify(v);
   alert(mytext)
}
</script>
</body>

</html>
